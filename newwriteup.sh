#!/bin/bash

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–≤–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ (–Ω–∞–∑–≤–∞–Ω–∏–µ –º–∞—à–∏–Ω—ã)
if [ -z "$1" ]; then
  echo "‚ùå –£–∫–∞–∂–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –º–∞—à–∏–Ω—ã:"
  echo "–ü—Ä–∏–º–µ—Ä: ./newwriteup.sh Relevant 192.168.56.101"
  exit 1
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ç–æ—Ä–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ (IP-–∞–¥—Ä–µ—Å)
if [ -z "$2" ]; then
  echo "‚ùå –£–∫–∞–∂–∏ IP-–∞–¥—Ä–µ—Å –º–∞—à–∏–Ω—ã:"
  echo "–ü—Ä–∏–º–µ—Ä: ./newwriteup.sh Relevant 192.168.56.101"
  exit 1
fi

# –í–∞–ª–∏–¥–∞—Ü–∏—è IP-–∞–¥—Ä–µ—Å–∞ (IPv4)
if ! [[ "$2" =~ ^([0-9]{1,3}\.){3}[0-9]{1,3}$ ]]; then
  echo "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç IP-–∞–¥—Ä–µ—Å–∞!"
  exit 1
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ –æ–∫—Ç–µ—Ç–æ–≤ (0‚Äì255)
IFS='.' read -r o1 o2 o3 o4 <<< "$2"
for octet in $o1 $o2 $o3 $o4; do
  if ((octet < 0 || octet > 255)); then
    echo "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π IP-–∞–¥—Ä–µ—Å: –æ–∫—Ç–µ—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç 0 –¥–æ 255."
    exit 1
  fi
done

MACHINENAME=$1
IP=$2
DATE=$(date +"%Y-%m-%d")

# –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–∞—Ç–∞–ª–æ–≥–æ–≤
mkdir -p "$MACHINENAME"/{scans,exploits,screenshots}
cd "$MACHINENAME" || exit

# –°–æ–∑–¥–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞ writeup.md
cat << EOF > writeup.md
# TryHackMe - $MACHINENAME

üìÖ –î–∞—Ç–∞: $DATE  
üß† –°–ª–æ–∂–Ω–æ—Å—Ç—å:  
üíª IP-–∞–¥—Ä–µ—Å: $IP  

---

## Sugar

\`\`\`bash
nmap_ctf() {
  local ip=\$1
  sudo nmap -sS -p- -Pn --max-parallelism 100 --min-rate 1000 -v -oN nmap-sS.txt \$ip && nmap -sT -Pn -sV -T4 -A -v -p "\$(grep -oP \"^[0-9]+(?=/tcp\\s+open)\" nmap-sS.txt | sort -n | paste -sd \",\")" -oN nmap-sV.txt \$ip
}
\`\`\`


## üîç –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

\`\`\`bash
export ip=$IP && nmap_ctf \$ip
\`\`\`

### nmap

![nmap scan](screenshots/nmap_scan.png)

---

## üïµÔ∏è Enumeration



## üìÇ –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞



## ‚öôÔ∏è –ü—Ä–∏–≤–∏–ª–µ–≥–∏–∏



## üèÅ –§–ª–∞–≥–∏

- User flag: 
- Root flag: 

---

## üìã –†–µ–∑—é–º–µ

üß∞ **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
  - nmap, ffuf, –∏ –¥—Ä.

üö® **–£—è–∑–≤–∏–º–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å:**  
  - Directory Traversal  
  - RCE —á–µ—Ä–µ–∑ —É—è–∑–≤–∏–º—ã–π —Å–∫—Ä–∏–ø—Ç  

üõ° **–°–æ–≤–µ—Ç—ã –ø–æ –∑–∞—â–∏—Ç–µ:**
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —á–∏—Å–ª–æ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
  - –û–±–Ω–æ–≤–ª—è—Ç—å –ü–û –¥–æ –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –≤–µ—Ä—Å–∏–π
  - –£–¥–∞–ª—è—Ç—å/–æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SUID-–±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤
  - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
  - –ü—Ä–∏–º–µ–Ω—è—Ç—å –ø—Ä–∏–Ω—Ü–∏–ø –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π


EOF

# Git –¥–µ–π—Å—Ç–≤–∏—è
cd .. || exit
git add "$MACHINENAME"
git commit -m "üìù –î–æ–±–∞–≤–ª–µ–Ω writeup –ø–æ –º–∞—à–∏–Ω–µ $MACHINENAME"
git push origin HEAD

echo "‚úÖ Writeup –¥–ª—è '$MACHINENAME' —Å–æ–∑–¥–∞–Ω –∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ GitHub!"
